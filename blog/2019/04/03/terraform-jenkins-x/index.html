<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.65.3" />

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">



<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform | Jenkins X</title><meta property="og:title" content="Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform" />
<meta property="og:description" content="Use Infrastructure as Code to provision Jenkins X clusters.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2019/04/03/terraform-jenkins-x/" />
<meta property="article:published_time" content="2019-04-03T07:36:00+02:00" />
<meta property="article:modified_time" content="2020-04-07T16:55:26+00:00" /><meta property="og:site_name" content="Jenkins X" />
<meta itemprop="name" content="Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform">
<meta itemprop="description" content="Use Infrastructure as Code to provision Jenkins X clusters.
">
<meta itemprop="datePublished" content="2019-04-03T07:36:00&#43;02:00" />
<meta itemprop="dateModified" content="2020-04-07T16:55:26&#43;00:00" />
<meta itemprop="wordCount" content="1832">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform"/>
<meta name="twitter:description" content="Use Infrastructure as Code to provision Jenkins X clusters.
"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-4216293-7', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="/scss/main.min.9706a37dbad600c9b65445ad0c3ba41cf6db12b931307dde28320cbde890d40c.css" as="style">
<link href="/scss/main.min.9706a37dbad600c9b65445ad0c3ba41cf6db12b931307dde28320cbde890d40c.css" rel="stylesheet" integrity="">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/default.min.css">
<script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>


    <title>Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform | Jenkins X</title>
  </head>
  <body class="td-page td-blog">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
	<a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 994.3 711.4" style="enable-background:new 0 0 994.3 711.4"><style>.st0{fill-rule:evenodd;clip-rule:evenodd;fill:#73c3d5}.st1{fill:#ff7f40}.st2{fill:#73c3d5}.st3{fill-rule:evenodd;clip-rule:evenodd;fill:#ff7f40}</style><g><g><g><path class="st0" d="M342.6 292.8c30.3.0 54.9 24.5 54.9 54.8s-24.6 54.8-54.9 54.8c-30.3.0-54.8-24.5-54.8-54.8S312.3 292.8 342.6 292.8"/><path class="st1" d="M342.6 265.9c22.6.0 43 9.1 57.8 23.9 14.8 14.8 23.9 35.2 23.9 57.8.0 22.5-9.2 43-23.9 57.8-14.8 14.8-35.2 23.9-57.8 23.9-22.5.0-43-9.1-57.7-23.9-14.8-14.8-23.9-35.2-23.9-57.8.0-22.5 9.1-43 23.9-57.8C299.6 275 320 265.9 342.6 265.9M392.8 297.3c-12.9-12.9-30.6-20.8-50.3-20.8-19.6.0-37.4 7.9-50.3 20.8-12.9 12.9-20.8 30.7-20.8 50.3s7.9 37.4 20.8 50.3c12.9 12.9 30.7 20.8 50.3 20.8 19.7.0 37.4-7.9 50.3-20.8 12.9-12.9 20.8-30.7 20.8-50.3C413.7 328 405.7 310.2 392.8 297.3"/></g><g><path class="st0" d="M651.7 292.8c30.3.0 54.8 24.5 54.8 54.8s-24.5 54.8-54.8 54.8-54.8-24.5-54.8-54.8C596.9 317.3 621.5 292.8 651.7 292.8"/><path class="st1" d="M651.7 265.9c22.5.0 43 9.1 57.7 23.9 14.8 14.8 23.9 35.2 23.9 57.8.0 22.5-9.1 43-23.9 57.8s-35.2 23.9-57.7 23.9c-22.6.0-43-9.1-57.8-23.9-14.8-14.8-23.9-35.2-23.9-57.8.0-22.5 9.2-43 23.9-57.8C608.7 275 629.1 265.9 651.7 265.9M702 297.3c-12.9-12.9-30.6-20.8-50.3-20.8-19.7.0-37.4 7.9-50.3 20.8-12.9 12.9-20.8 30.7-20.8 50.3s8 37.4 20.8 50.3c12.9 12.9 30.6 20.8 50.3 20.8 19.6.0 37.4-7.9 50.3-20.8 12.9-12.9 20.8-30.7 20.8-50.3S714.9 310.2 702 297.3"/></g></g><path class="st0" d="M993.3 40c-18.8 31.1-53.4 81.8-60.7 95.1l-4.9-57.9-95.2 100.5c-32.7-62.1-92.5-107.9-163.4-121.4C651.3 24.6 579.3 1.8 505.3.1 502.6.0 499.9.0 497.1.0c-2.7.0-5.5.0-8.2.1-74 1.7-146 24.5-163.8 56.2-71 13.5-130.8 59.3-163.4 121.4L66.5 77.2l-4.9 57.9C54.3 121.7 19.8 71.1 1 40-4.1 58.4 12.3 201 16.8 219.4c4.4 18.1 34.2 142.5 57 140.4 3.2-1.2 9.3-26.3 16.9-48.8l52.2 97.1C167.5 505.9 247.3 582.4 347 602c1-7.1 2.7-14.2 5.3-20.6-111.3-21.2-196.1-119.5-196.1-236.7v-58.9c0-100.7 71.1-185.6 165.7-207 .2.8.4 1.5.7 2.2l55.7 149.9c7 18.8 18.8 35.1 41.1 35.1h77.7 77.7c22.3.0 34.1-16.3 41.1-35.1l55.7-149.9c.3-.7.5-1.5.7-2.2 94.5 21.4 165.7 106.3 165.7 207v58.9c0 117.2-84.8 215.5-196.1 236.7 2.7 6.4 4.4 13.5 5.3 20.6 99.7-19.6 179.5-96 204.1-193.9l52.2-97.1c7.6 22.5 13.8 47.5 16.9 48.8 22.8 2.1 52.6-122.3 57-140.4C982 201 998.4 58.3 993.3 40zM78.4 258.7 69 320C41.5 240.6 27.1 180.7 15.8 95.5l58.3 106.7 10.7-80.7 67.2 76.9c-11 27-17.1 56.5-17.1 87.3v58.9c0 3.4.1 6.7.2 10.1L78.4 258.7zM651.7 73.5 596 223.4c-4.1 10.9-9.6 21.2-21.2 21.2h-77.5-77.5c-11.7.0-17.2-10.3-21.2-21.2L342.6 73.5C336 55.7 417.8 31.6 497.1 31 576.5 31.6 658.3 55.7 651.7 73.5zM925.3 320l-9.4-61.3-56.9 96c.1-3.4.2-6.7.2-10.1v-58.9c0-30.8-6.1-60.3-17.1-87.3l67.2-76.9 10.7 80.7 58.3-106.7C967.2 180.7 952.8 240.6 925.3 320z"/><path class="st2" d="M595.8 521.3h-98.6-98.6c-70.4.0-107.9-34.6-120.7-49.2l-10.5 8.8c14.5 16.5 55.7 54 131.2 54h98.6 98.6c75.4.0 116.7-37.5 131.2-54l-10.5-8.8C703.7 486.7 666.1 521.3 595.8 521.3z"/><path class="st3" d="M623 557.9c-11.5-6-24.2-5.5-36.1-.9-12.5 4.8-25 11.5-36.7 18-5.9 3.2-11.8 6.6-17.6 9.9-5.8-3.3-12.5-5.2-19.6-5.2h-31.6c-7.1.0-13.8 1.9-19.6 5.2-5.8-3.4-11.7-6.7-17.6-9.9-11.7-6.5-24.1-13.2-36.7-18-11.9-4.6-24.6-5-36.1.9-26.6 13.7-30.6 51.9-28.4 78.3 2.1 26.4 12.5 68.5 43.2 74.5 5.3 1 10.6.8 15.8-.6 19.9-5.3 42.3-16.5 62.5-28.9 5.2 2.4 10.9 3.9 17 3.9H513c6.1.0 11.8-1.4 17-3.8 20.1 12.4 42.6 23.5 62.4 28.9 5.2 1.4 10.5 1.6 15.8.6 30.7-6 41.1-48.1 43.2-74.5C653.5 609.8 649.6 571.6 623 557.9zM396.4 689.7c-37.4 10-51-133.8 3.5-112.9 12 4.6 27.6 13 46.4 23.7-3.2 5.7-5 12.3-5 19.3v2.6c-8.9-2.8-21-5.8-36.5-9.4 25.7 16.2 17.9 12 35.2 20.6-19.2 11.4-10.5 5.7-37.2 25.8 16.3-5.4 29.1-9.8 38.5-13.6.1 7.6 2.4 14.7 6.2 20.7C432.2 675.6 413.7 685.1 396.4 689.7zm201.5.0c-17.2-4.6-35.8-14.1-51.2-23.2 3.6-5.7 5.8-12.4 6.2-19.5 9 3.5 20.9 7.6 35.5 12.4-25.9-19.4-18.6-14.8-35.4-24.7v-2c15-7.4 8.7-4.1 33.4-19.7-13.8 3.2-24.9 6-33.4 8.5v-1.7c0-7-1.8-13.6-5-19.3 18.9-10.7 34.4-19.1 46.4-23.7C648.8 555.9 635.3 699.7 597.9 689.7z"/></g></svg></span><span class="text-uppercase font-weight-bold">Jenkins X</span>
	</a>
	<a class="navbar-brand" href="https://cd.foundation/">
		<span>
			<svg width="36" height="18" xmlns="http://www.w3.org/2000/svg" role="img" xmlns:xlink="http://www.w3.org/1999/xlink"
				viewBox="-3.23 44.77 362.70 271.95">
				<defs>
					<linearGradient id="a" x1="359.765" x2="104.082" y1="134.295" y2="124.577"
						gradientTransform="matrix(1 0 0 -1 0 439.068)" gradientUnits="userSpaceOnUse">
						<stop offset="0" stop-color="#ed1c24"></stop>
						<stop offset="1" stop-color="#f7941d"></stop>
					</linearGradient>
					<linearGradient id="b" x1="355.202" x2="99.519" y1="254.467" y2="244.749" xlink:href="#a"></linearGradient>
					<linearGradient id="c" x1="183.903" x2="10.612" y1="227.598" y2="221.023" xlink:href="#a"></linearGradient>
					<linearGradient id="d" x1="367.119" x2="157.995" y1="265.311" y2="257.091" xlink:href="#a"></linearGradient>
				</defs>
				<path fill="#c49a6c"
					d="M231.52 309.278c2.483-.332 4.895-.77 7.255-1.329s4.649-1.206 6.991-1.957c13.494-4.58 25.187-12.952 36.374-24.593l-.14-.175c-14.944 15.486-30.693 25.344-50.48 28.054z">
				</path>
				<path fill="url(#a)" d="M224.232 309.96h.332c1.084 0 2.15-.14 3.216-.228a93.844 93.844 0 0 1-3.233.227z"></path>
				<path fill="url(#b)" d="M284.692 187.187l-.122.192.122-.192z"></path>
				<path fill="url(#c)"
					d="M146.145 231.847a150.844 150.844 0 0 1-12.97 15.862c-7.582 7.889-15.507 13.563-24.652 16.667a47.832 47.832 0 0 1-4.738 1.326 56.959 56.959 0 0 1-4.916.9 38.32 38.32 0 0 1-1.682.214l-.912.083c-.723.059-1.445.118-2.18.154h-3.068a42.325 42.325 0 0 1-9.192-1.043 49.977 49.977 0 0 1-6.764-2.002 43.097 43.097 0 0 1-4.525-1.954c-1.493-.77-2.961-1.516-4.407-2.37a59.5 59.5 0 0 1-17.105-15.399 59.714 59.714 0 0 1-2.914-4.311 53.09 53.09 0 0 1-1.291-2.263 51.985 51.985 0 0 1-2.263-4.738 46.72 46.72 0 0 1 0-36.426 51.986 51.986 0 0 1 2.263-4.738 54.14 54.14 0 0 1 1.291-2.263 59.742 59.742 0 0 1 2.914-4.311 59.714 59.714 0 0 1 17.105-15.4 60.828 60.828 0 0 1 4.407-2.369q2.217-1 4.525-1.777a49.976 49.976 0 0 1 6.906-2.073 42.325 42.325 0 0 1 9.192-1.042h3.128c.722 0 1.445.094 2.155.154l1.043.106 1.019.119c1.8.237 3.553.557 5.271.96.853.2 1.694.426 2.523.663a51.186 51.186 0 0 1 11.846 5.176 59.645 59.645 0 0 1 4.395 2.89 74.485 74.485 0 0 1 8.386 7.108q2.038 1.99 4.063 4.193l.083-.13a159.395 159.395 0 0 1 11.064 13.942c5.437-8.576 13.658-21.464 16.584-25.74 1.185-1.718 2.37-3.46 3.66-5.212-13.54-16.513-29.827-30.23-51.587-36.082h-.154a89.397 89.397 0 0 0-3.187-.794l-.45-.107a92.565 92.565 0 0 0-3.151-.627l-.628-.119a80.578 80.578 0 0 0-3.743-.569h-.142a58.29 58.29 0 0 0-2.073-.236h-.391l-1.872-.166h-.568l-1.754-.119h-.675l-1.777-.07h-3.115c-46.447-.25-87.125 40.476-87.125 86.911s40.725 87.173 87.172 87.173h3.14l1.729-.071h.734l1.67-.095h.676l1.706-.154h.568l1.813-.213.414-.06 1.967-.272h.213a125.91 125.91 0 0 0 3.553-.628l.652-.142c.96-.201 1.907-.415 2.855-.64l.58-.142a86.66 86.66 0 0 0 3.009-.817l.237-.071c20.73-6.077 36.425-19.392 49.55-35.277-2.037-3.068-3.4-5.366-4.039-6.48z">
				</path>
				<path fill="url(#d)"
					d="M318.05 51.733v94.66a85.514 85.514 0 0 0-52.595-18.729h-3.115l-1.777.072-.7.047-1.752.118h-.569l-1.871.166h-.391c-.7.071-1.386.142-2.073.237h-.154c-1.256.154-2.5.355-3.732.569l-.628.118c-1.066.19-2.108.403-3.15.628l-.45.107c-30.35 6.858-50.333 28.808-66.822 52.82-.7 1.018-1.35 2.049-2.038 3.068-2.25 3.423-5.46 8.422-8.635 13.397-4.17 6.527-8.292 13.03-9.939 15.66l20.624 32.137s21.997 40.465 61.68 51.482l.237.07c.995.297 2.002.558 3.009.818l.58.142c.936.237 1.896.439 2.855.64l.652.142c1.184.225 2.369.439 3.553.628h.214l1.966.273.415.059 1.812.213h.569l1.705.154h.676l1.67.095h.734l1.73.07h3.139c54.703 0 86.355-30.964 87.149-85.063V51.733zm-52.595 215.403h-3.068c-.734 0-1.457-.095-2.18-.154l-.912-.083c-.568-.06-1.125-.13-1.682-.213a49.077 49.077 0 0 1-9.571-2.275 49.612 49.612 0 0 1-6.634-2.83 55.792 55.792 0 0 1-6.254-3.768 63.068 63.068 0 0 1-3.009-2.215 82.399 82.399 0 0 1-8.683-7.925l-.095.119c-1.255-1.303-2.487-2.69-3.731-4.11-.154-.167-.296-.356-.45-.534-.628-.722-1.256-1.445-1.884-2.215s-1.125-1.398-1.682-2.097-.888-1.101-1.338-1.682a184.467 184.467 0 0 1-6.053-8.292c-.7-.995-1.398-2.025-2.109-3.056-.379-.569-.77-1.184-1.185-1.73-.675-1.018-1.362-2.013-2.049-3.056l-.355-.545c-1.185-1.812-2.37-3.684-3.649-5.603q2.95-4.608 5.817-8.86c1.907-2.831 3.79-5.556 5.662-8.138s3.72-5.046 5.591-7.38 3.72-4.525 5.603-6.586q2.026-2.203 4.063-4.194c1.374-1.338 2.748-2.594 4.158-3.778s2.807-2.287 4.252-3.329a57.594 57.594 0 0 1 7.748-4.62c.331-.166.663-.367 1.006-.533l.226-.118c1.41-.652 2.843-1.185 4.3-1.73l.485-.201c.273-.083.557-.142.83-.237a44.943 44.943 0 0 1 3.34-.948l1.374-.343a60.798 60.798 0 0 1 4.738-.841l1.019-.119 1.042-.106c.711 0 1.434-.119 2.156-.154h3.128a42.431 42.431 0 0 1 4.572.26 48.011 48.011 0 0 1 6.93 1.35c1.54.427 3.08.925 4.596 1.505a48.724 48.724 0 0 1 4.525 1.955c1.493.722 2.961 1.516 4.407 2.369s2.866 1.8 4.24 2.784 2.725 2.049 4.028 3.174a58.459 58.459 0 0 1 8.837 9.477 59.73 59.73 0 0 1 2.914 4.312 51.067 51.067 0 0 1 5.318 11.916 47.38 47.38 0 0 1 1.185 5.165 45.567 45.567 0 0 1 .71 8.09c.072 35.964-16.062 52.122-52.227 52.122z">
				</path>
			</svg>
		</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/about/" ><span>About</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="/docs/" ><span>Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link active" href="/blog/" ><span class="active">Blog</span></a>
			</li>
			
			
				<li class="nav-item dropdown d-none d-lg-block">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	Community
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/community/">Join the community</a>
	
	<a class="dropdown-item" href="/community/talksdemos/">Demos and Talks</a>
	
	<a class="dropdown-item" href="/community/events/">Events</a>
	
</div>
				</li>
			
			
			
			<li class="nav-item dropdown d-none d-lg-block">
				

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	English
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/zh/">中文</a>
	
	<a class="dropdown-item" href="/es/">Español</a>
	
</div>
			</li>
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">
 <input id="search-input" type="search" class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete="off">
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <nav class="collapse td-sidebar-nav pt-2 pl-4" id="td-section-nav">
    
    <div class="nav-item dropdown d-block d-lg-none">
      

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	English
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/zh/">中文</a>
	
	<a class="dropdown-item" href="/es/">Español</a>
	
</div>
    </div>
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/blog/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Blog</a>
  </li>
  <ul>
    <li class="collapse show" id="blog">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/blog/news/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">News</a>
  </li>
  <ul>
    <li class="collapse show" id="blognews">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200325cjxd-march-20" href="/blog/2020/03/25/cjxd-march-20/">CloudBees contributions to Jenkins X - March 2020</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200323gsoc2020" href="/blog/2020/03/23/gsoc2020/">Google Summer of Code 2020 ☀️</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200311tekton" href="/blog/2020/03/11/tekton/">Jenkins X  ❤ Tekton</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200310walkthrough" href="/blog/2020/03/10/walkthrough/">Walkthrough: Setting up Jenkins X on a Kubernetes cluster</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200305gsm-controller" href="/blog/2020/03/05/gsm-controller/">Google Secrets Manager Kubernetes controller</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200228jxl-feb-20" href="/blog/2020/02/28/jxl-feb-20/">Jenkins X Labs</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200226cjxd-feb-20" href="/blog/2020/02/26/cjxd-feb-20/">CloudBees contributions to Jenkins X - February 2020</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200214jxfosdemtalks2020" href="/blog/2020/02/14/jxfosdemtalks2020/">3 Jenkins X talks at FOSDEM 2020 </a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200122outreachy2019" href="/blog/2020/01/22/outreachy2019/">Asking and Finding help - Outreachy</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200114happy-second-birthday" href="/blog/2020/01/14/happy-second-birthday/">Happy Second Birthday Jenkins X!</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200110outreachy2019" href="/blog/2020/01/10/outreachy2019/">Outreachy - Motivation to apply! </a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20200109jxfosdem2020" href="/blog/2020/01/09/jxfosdem2020/">FOSDEM 2020</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191128jenkins-x-outreachy-welcome" href="/blog/2019/11/28/jenkins-x-outreachy-welcome/">Welcome Neha Gupta to Jenkins X as our Outreachy intern</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191108jenkins-x-hackathon-lisbon" href="/blog/2019/11/08/jenkins-x-hackathon-lisbon/">Contribute to Jenkins X at our Hackathon in Lisbon on 2 December</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191018jenkins-x-contributor-summit-lisbon" href="/blog/2019/10/18/jenkins-x-contributor-summit-lisbon/">Join Us at the Jenkins X Contributor Summit Lisbon on 3 December</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191016intro-to-jenkins-x-by-oscar-andrew" href="/blog/2019/10/16/intro-to-jenkins-x-by-oscar-andrew/">Introduction to Jenkins X @ Jenkins World | DevOps World Lisbon</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191009fosdem2020" href="/blog/2019/10/09/fosdem2020/">CFP: CI/CD Devroom at FOSDEM 2020</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20191001outreachy2019" href="/blog/2019/10/01/outreachy2019/">Outreachy</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190927hacktoberfest2019" href="/blog/2019/09/27/hacktoberfest2019/">Contribute to Jenkins X as part of Hacktoberfest</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190903jenkinsworld-2019-takeaways" href="/blog/2019/09/03/jenkinsworld-2019-takeaways/">Jenkins X Key Takeaways from Jenkins World 2019</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190731new-logo-jenkins-x" href="/blog/2019/07/31/new-logo-jenkins-x/">A New Logo for Jenkins X</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190729jenkins-x-observability" href="/blog/2019/07/29/jenkins-x-observability/">Increasing CI/CD Pipeline Observability in Jenkins X</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190723serverless-deployments" href="/blog/2019/07/23/serverless-deployments/">Using Jenkins X To Define And Run Serverless Deployments</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190718jenkins-world-lunch-demos" href="/blog/2019/07/18/jenkins-world-lunch-demos/">DevOps World - Jenkins World 2019 San Francisco: Lunch Time Demos</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190716jenkins-x-contributor-summit" href="/blog/2019/07/16/jenkins-x-contributor-summit/">Join Us at the Jenkins X Contributor Summit San Francisco, Monday August 12, 2019</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190617alibaba-container-service-jenkins-x" href="/blog/2019/06/17/alibaba-container-service-jenkins-x/">Installing Jenkins X on Alibaba Cloud Container Service</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190606jenkins-world-agenda" href="/blog/2019/06/06/jenkins-world-agenda/">DevOps World-Jenkins World 2019 San Francisco: Agenda is Live</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190417jenkins-community-awards" href="/blog/2019/04/17/jenkins-community-awards/">Jenkins Community Awards</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-blog20190403terraform-jenkins-x" href="/blog/2019/04/03/terraform-jenkins-x/">Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190309jenkins-x-cdf" href="/blog/2019/03/09/jenkins-x-cdf/">Jenkins X joins the CDF</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190219jenkins-x-next-gen-pipeline-engine" href="/blog/2019/02/19/jenkins-x-next-gen-pipeline-engine/">Jenkins X Pipelines integrated with Tekton</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20190114happy-first-birthday" href="/blog/2019/01/14/happy-first-birthday/">Happy 1st Birthday Jenkins X</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20181020serverless-jenkins" href="/blog/2018/10/20/serverless-jenkins/">Serverless Jenkins</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20181003helm-without-tiller" href="/blog/2018/10/03/helm-without-tiller/">Helm 2.x without Tiller</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20180906jenkins-x-at-jenkinsworld" href="/blog/2018/09/06/jenkins-x-at-jenkinsworld/">Jenkins X at Jenkins World</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20180505jenkins-x-does-kubecon" href="/blog/2018/05/05/jenkins-x-does-kubecon/">Jenkins X does KubeCon</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20180319introducing-jenkins-x" href="/blog/2018/03/19/introducing-jenkins-x/">Introducing Jenkins X</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-blog20180309jep-400-submitted" href="/blog/2018/03/09/jep-400-submitted/">JEP 400 submitted</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            




<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">





<p>
  <h4>
    <a href="https://github.com/jenkins-x/jx-docs/edit/master/content/en/blog/news/provision-jx-clusters-terraform.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
  </h4>
  <a href="/docs/contributing/documentation/changes/" target="_blank"><i>(Learn how to edit)</i></a>
</p>
<a href="https://github.com/jenkins-x/jx-docs/issues/new?title=Managing%20Jenkins%20X%20Kubernetes%20Clusters%20Using%20Infrastructure%20as%20Code%20With%20Terraform" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>


<a href="https://github.com/jenkins-x/jx/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> Create project issue</a>

</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#terraform-clusters-for-aws-gcp-and-azure">Terraform clusters for AWS, GCP and Azure</a></li>
    <li><a href="#benefits-of-using-iac-to-manage-your-k8s-clusters">Benefits of Using IaC to Manage Your K8s Clusters</a></li>
  </ul>

  <ul>
    <li><a href="#folder-structure-output">Folder Structure Output</a></li>
  </ul>

  <ul>
    <li><a href="#downloading-credentials-json-file">Downloading Credentials JSON File</a></li>
  </ul>

  <ul>
    <li><a href="#set-kubectl-context">Set Kubectl Context</a></li>
  </ul>

  <ul>
    <li><a href="#accessing-kubernetes-dashboard">Accessing kubernetes dashboard</a>
      <ul>
        <li><a href="#get-access-token">Get Access token</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
            <a class="btn btn-lg -bg-orange td-rss-button d-none d-lg-block" href="/blog/news/index.xml" target="_blank">
              RSS <i class="fa fa-rss ml-2 "></i>
            </a>
            
<div class="td-content">
	<h1>Managing Jenkins X Kubernetes Clusters Using Infrastructure as Code With Terraform</h1>
	<div class="lead">Use Infrastructure as Code to provision Jenkins X clusters.</div>
	<div class="td-byline mb-4">
		By <b>Oscar Medina</b> |
		<time datetime="2019-04-03" class="text-muted">Wednesday, April 03, 2019</time>
	</div>
	<figure>
<img src="/images/jenkinsTerraform.png"/>
<figcaption>
<h5>Provision Jenkins X Kubernetes Clusters using Terraform</h5>
</figcaption>
</figure>


<div class="alert alert-primary" role="alert">

CAUTION: Do not make updates to the cluster that require recreating the cluster resources, all data will be lost.  Only changes that update the cluster are supported at this time.
</div>

<h1 id="overview">Overview</h1>
<p>Many organizations have adopted DevOps practices in the last few years.  This is valuable as it relates to Jenkins X as we provide a way to manage the Kubernetes clusters  Infrastructure as Code which is one of the core concepts of DevOps practices as it relates to automation.</p>
<p>Many environments may only allow for creating cloud resources using IaC, therefore we provide you with guidance on how to get started using Terraform to manage your Jekins X clusters.</p>
<p>Our objective is to bring awareness to our Jenkins X users on know that they can manage the cluster changes and version them by placing the Terraform code source control and adopting the typical developer workflow which includes PRs in source control to make infrastructure changes in a controlled manner.</p>
<h2 id="terraform-clusters-for-aws-gcp-and-azure">Terraform clusters for AWS, GCP and Azure</h2>
<p>Jenkins X supports generating Terraform plans and code for all three leading clouds (AWS, Azure and GCP).</p>
<p>On this post we walk you through the steps for terraforming clusters in GKE.</p>
<h2 id="benefits-of-using-iac-to-manage-your-k8s-clusters">Benefits of Using IaC to Manage Your K8s Clusters</h2>
<ul>
<li>This is great, because at many companies the Ops team typically is already using IaC to manage the resources deployed to the cloud</li>
<li>Our Users gain the ability to version their infrastructure and follow the typical developer workflow as the code is in Github</li>
<li>Changes to the cluster can be automated, added to a pipeline</li>
</ul>
<h1 id="prerequisites">Prerequisites</h1>
<p>To get started, you must have the following items installed on your machine.</p>
<ul>
<li>The <code>jx</code> CLI installed.</li>
<li>Terraform - can be installed using <code>brew install terraform</code></li>
<li>GCP account with proper rights to create resources</li>
<li>The Google Cloud CLI <code>gcloud</code>
<code>kubectl</code> must also be installed</li>
</ul>
<h1 id="step-1---create-terraform-plan">Step 1 - Create Terraform Plan</h1>
<p>Our first task is to generate the Terraform code for each cluster, we create a Dev, Staging and Production cluster.</p>
<p>We execute the <code>jx create terraform -c dev=gke -c stage=gke -c prod=gke</code>.</p>
<p>The command generates three different clusters for each environment respectively in GCP.  Other providers supported are  aks, eks.</p>
<h2 id="folder-structure-output">Folder Structure Output</h2>
<p>Running the previous command, outputs the following folder structure wherever we executed the command locally.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-txt" data-lang="txt">├── README.md
├── build.sh
├── ci-demo-206601-121d21dc79ac.json
└── clusters
├── dev
│   └── terraform
│       ├── README.md
│       ├── key.json
│       ├── main.tf
│       ├── output.tf
│       ├── terraform.tf
│       ├── terraform.tfvars
│       └── variables.tf
├── prod
│   └── terraform
│       ├── README.md
│       ├── main.tf
│       ├── output.tf
│       ├── terraform.tf
│       ├── terraform.tfvars
│       └── variables.tf
└── stage
└── terraform
├── README.md
├── main.tf
├── output.tf
├── terraform.tf
├── terraform.tfvars
└── variables.tf

7 directories, 22 files
</code></pre></div><p>We now have a great code-base to create our clusters on GKE for three different environments.</p>


<div class="alert alert-primary" role="alert">

NOTE: On this Post, we will only create the Dev Cluster, although the process is the same for creating the other Kubernetes clusters.
First we need to make sure we have credentials to execute our Terraform code.
</div>

<h1 id="step-2---get-gke-credentials">Step 2 - Get GKE Credentials</h1>
<p>Jenkins X creates a Service Account (SA) for each cluster.</p>
<p>For our dev cluster, it has created the <a href="mailto:jx-questerring-dev@ci-demo-206601.iam.gserviceaccount.com">jx-questerring-dev@ci-demo-206601.iam.gserviceaccount.com</a> account.</p>
<p>We need to download the <code>json</code> file in order to pass as credentials to our <code>terraform.tf</code> file which contains the definition to access the Terraform Backend.</p>
<h2 id="downloading-credentials-json-file">Downloading Credentials JSON File</h2>
<p>To download the SA account credentials, go to the GCP Console &gt; IAM &amp;  Admin &gt; Service Accounts.</p>
<p>We find the one for our cluster which is named in our case
as follows: <code>jx-questerring-dev@ci-demo-206601.iam.gserviceaccount.com</code></p>
<p>We click on the file <em>name</em>  &gt; <em>edit</em>, then click on <em>create key</em> in JSON format, download and save in our project folder structure.</p>
<p>We now add a reference within the <code>terraform.tf</code> as shown below.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tf" data-lang="tf"><span style="color:#960050;background-color:#1e0010">terraform</span> {
<span style="color:#a6e22e">    required_version</span> <span style="color:#f92672">=</span><span style="color:#a6e22e"> &#34;&gt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">11</span>.<span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&#34;</span>
    <span style="color:#960050;background-color:#1e0010">backend</span> <span style="color:#e6db74">&#34;gcs&#34;</span> {
<span style="color:#a6e22e">        bucket</span>      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ci-demo-206601-questerring-terraform-state&#34;</span>
<span style="color:#a6e22e">        prefix</span>      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;dev&#34;</span>
<span style="color:#a6e22e">        credentials</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;key.json&#34;</span>
    }
}
</code></pre></div><p>Notice that we added the <code>credentials</code> portion and point to the credentials <code>json</code> file we downloaded from the Google IAM &amp; Admin web console.</p>
<h1 id="step-3---initiate-terraform-backend">Step 3 - Initiate Terraform Backend</h1>
<p>We are now ready to initiate Terraform backend.  Terraform backends are used to save the Terraform State remotely.  This is great for when a team needs to collaborate on making infrastructure changes, because the Terraform State is stored in the GCP Bucket that was also created when we executed our initial command to create the cluster.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tf" data-lang="tf"><span style="color:#960050;background-color:#1e0010">$</span> <span style="color:#960050;background-color:#1e0010">terraform</span> <span style="color:#960050;background-color:#1e0010">init</span>
<span style="color:#960050;background-color:#1e0010">Initializing</span> <span style="color:#960050;background-color:#1e0010">the</span> <span style="color:#960050;background-color:#1e0010">backend</span>...

<span style="color:#960050;background-color:#1e0010">Successfully</span> <span style="color:#960050;background-color:#1e0010">configured</span> <span style="color:#960050;background-color:#1e0010">the</span> <span style="color:#960050;background-color:#1e0010">backend</span> <span style="color:#e6db74">&#34;gcs&#34;</span><span style="color:#960050;background-color:#1e0010">!</span> <span style="color:#960050;background-color:#1e0010">Terraform</span> <span style="color:#960050;background-color:#1e0010">will</span> <span style="color:#960050;background-color:#1e0010">automatically</span>
<span style="color:#960050;background-color:#1e0010">use</span> <span style="color:#960050;background-color:#1e0010">this</span> <span style="color:#960050;background-color:#1e0010">backend</span> <span style="color:#960050;background-color:#1e0010">unless</span> <span style="color:#960050;background-color:#1e0010">the</span> <span style="color:#960050;background-color:#1e0010">backend</span> <span style="color:#960050;background-color:#1e0010">configuration</span> <span style="color:#960050;background-color:#1e0010">changes</span>.

<span style="color:#960050;background-color:#1e0010">Initializing</span> <span style="color:#66d9ef">provider</span><span style="color:#960050;background-color:#1e0010"> plugins</span>...
<span style="color:#960050;background-color:#1e0010">Checking</span> <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">available</span> <span style="color:#66d9ef">provider</span><span style="color:#960050;background-color:#1e0010"> plugins on https://releases</span>.<span style="color:#960050;background-color:#1e0010">hashicorp</span>.<span style="color:#960050;background-color:#1e0010">com</span>...
<span style="color:#960050;background-color:#1e0010">Downloading</span> <span style="color:#960050;background-color:#1e0010">plugin</span> <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#66d9ef">provider</span> <span style="color:#e6db74">&#34;google&#34;</span> (<span style="color:#960050;background-color:#1e0010">2</span>.<span style="color:#960050;background-color:#1e0010">3</span>.<span style="color:#960050;background-color:#1e0010">0</span>)...

<span style="color:#960050;background-color:#1e0010">Terraform</span> <span style="color:#960050;background-color:#1e0010">has</span> <span style="color:#960050;background-color:#1e0010">been</span> <span style="color:#960050;background-color:#1e0010">successfully</span> <span style="color:#960050;background-color:#1e0010">initialized!</span>
</code></pre></div><p>We have initiated Terraform and our Terraform State is now configured to use the GCP Buket specified in the terraform.tf file.</p>
<h1 id="step-4---terraform-plan">Step 4 - Terraform Plan</h1>
<p>We now can execute a <code>terraform plan</code> and see what will be created.  At this point, we can opt to augment the terraform code.</p>
<p>For example, you may have an existing network that you wish to deploy the cluster in.  You may also wish to enable the an add-on, or you can specify the cluster_ipv4_cidr_block and many other things (see <a href="https://www.terraform.io/docs/providers/google/r/container_cluster.html">https://www.terraform.io/docs/providers/google/r/container_cluster.html</a>) for details.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ terraform plan

Refreshing Terraform state in-memory prior to plan...
The refreshed state will be used to calculate this plan, but will not be
persisted to local or remote state storage.
----

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
+ create

Terraform will perform the following actions:

+ google_container_cluster.jx-cluster
id:                                    &lt;computed&gt;
additional_zones.#:                    &lt;computed&gt;
addons_config.#:                       &lt;computed&gt;
cluster_autoscaling.#:                 &lt;computed&gt;
cluster_ipv4_cidr:                     &lt;computed&gt;
description:                           <span style="color:#e6db74">&#34;jx k8s cluster provisioned and managed via Terraform.&#34;</span>
enable_binary_authorization:           &lt;computed&gt;
enable_kubernetes_alpha:               <span style="color:#e6db74">&#34;false&#34;</span>
enable_legacy_abac:                    <span style="color:#e6db74">&#34;false&#34;</span>
enable_tpu:                            &lt;computed&gt;
endpoint:                              &lt;computed&gt;
initial_node_count:                    <span style="color:#e6db74">&#34;3&#34;</span>
instance_group_urls.#:                 &lt;computed&gt;
ip_allocation_policy.#:                &lt;computed&gt;
location:                              &lt;computed&gt;
logging_service:                       <span style="color:#e6db74">&#34;logging.googleapis.com&#34;</span>
master_auth.#:                         &lt;computed&gt;
master_ipv4_cidr_block:                &lt;computed&gt;
master_version:                        &lt;computed&gt;
monitoring_service:                    <span style="color:#e6db74">&#34;monitoring.googleapis.com&#34;</span>
name:                                  <span style="color:#e6db74">&#34;questerring-dev&#34;</span>
network:                               <span style="color:#e6db74">&#34;default&#34;</span>
network_policy.#:                      &lt;computed&gt;
node_config.#:                         &lt;computed&gt;
node_locations.#:                      &lt;computed&gt;
node_pool.#:                           &lt;computed&gt;
node_version:                          &lt;computed&gt;
private_cluster:                       &lt;computed&gt;
project:                               &lt;computed&gt;
region:                                &lt;computed&gt;
remove_default_node_pool:              <span style="color:#e6db74">&#34;true&#34;</span>
resource_labels.%:                     <span style="color:#e6db74">&#34;3&#34;</span>
resource_labels.created-by:            <span style="color:#e6db74">&#34;me&#34;</span>
resource_labels.created-timestamp:     <span style="color:#e6db74">&#34;20190326093418&#34;</span>
resource_labels.created-with:          <span style="color:#e6db74">&#34;terraform&#34;</span>
zone:                                  <span style="color:#e6db74">&#34;us-west1-a&#34;</span>

+ google_container_node_pool.jx-node-pool
id:                                    &lt;computed&gt;
autoscaling.#:                         <span style="color:#e6db74">&#34;1&#34;</span>
autoscaling.0.max_node_count:          <span style="color:#e6db74">&#34;5&#34;</span>
autoscaling.0.min_node_count:          <span style="color:#e6db74">&#34;3&#34;</span>
cluster:                               <span style="color:#e6db74">&#34;questerring-dev&#34;</span>
initial_node_count:                    &lt;computed&gt;
instance_group_urls.#:                 &lt;computed&gt;
location:                              &lt;computed&gt;
management.#:                          <span style="color:#e6db74">&#34;1&#34;</span>
management.0.auto_repair:              <span style="color:#e6db74">&#34;true&#34;</span>
management.0.auto_upgrade:             <span style="color:#e6db74">&#34;false&#34;</span>
max_pods_per_node:                     &lt;computed&gt;
name:                                  <span style="color:#e6db74">&#34;default-pool&#34;</span>
name_prefix:                           &lt;computed&gt;
node_config.#:                         <span style="color:#e6db74">&#34;1&#34;</span>
node_config.0.disk_size_gb:            <span style="color:#e6db74">&#34;100&#34;</span>
node_config.0.disk_type:               &lt;computed&gt;
node_config.0.guest_accelerator.#:     &lt;computed&gt;
node_config.0.image_type:              &lt;computed&gt;
node_config.0.local_ssd_count:         &lt;computed&gt;
node_config.0.machine_type:            <span style="color:#e6db74">&#34;n1-standard-2&#34;</span>
node_config.0.metadata.%:              &lt;computed&gt;
node_config.0.oauth_scopes.#:          <span style="color:#e6db74">&#34;7&#34;</span>
node_config.0.oauth_scopes.1277378754: <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/monitoring&#34;</span>
node_config.0.oauth_scopes.1693978638: <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/devstorage.full_control&#34;</span>
node_config.0.oauth_scopes.172152165:  <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/logging.write&#34;</span>
node_config.0.oauth_scopes.1733087937: <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/cloud-platform&#34;</span>
node_config.0.oauth_scopes.2184564866: <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/service.management&#34;</span>
node_config.0.oauth_scopes.299962681:  <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/compute&#34;</span>
node_config.0.oauth_scopes.3663490875: <span style="color:#e6db74">&#34;https://www.googleapis.com/auth/servicecontrol&#34;</span>
node_config.0.preemptible:             <span style="color:#e6db74">&#34;true&#34;</span>
node_config.0.service_account:         &lt;computed&gt;
node_count:                            <span style="color:#e6db74">&#34;3&#34;</span>
project:                               &lt;computed&gt;
region:                                &lt;computed&gt;
version:                               &lt;computed&gt;
zone:                                  <span style="color:#e6db74">&#34;us-west1-a&#34;</span>
Plan: <span style="color:#ae81ff">2</span> to add, <span style="color:#ae81ff">0</span> to change, <span style="color:#ae81ff">0</span> to destroy.
----

Note: You didn<span style="color:#e6db74">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span><span style="color:#e6db74">can&#39;</span>t guarantee that exactly these actions will be performed <span style="color:#66d9ef">if</span>
<span style="color:#e6db74">&#34;terraform apply&#34;</span> is subsequently run.

</code></pre></div><h1 id="step-5---create-cluster-using-terraform-apply">Step 5 - Create Cluster Using Terraform Apply</h1>
<p>Now that we&rsquo;ve seen what will be created and using the default terraform code generated, let us create said resources!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ terraform apply
.....trimmed <span style="color:#66d9ef">for</span> brevity
Apply complete! Resources: <span style="color:#ae81ff">2</span> added, <span style="color:#ae81ff">0</span> changed, <span style="color:#ae81ff">0</span> destroyed.

Outputs:

cluster_endpoint <span style="color:#f92672">=</span> 35.203.147.59
cluster_master_version <span style="color:#f92672">=</span> 1.11.7-gke.12
</code></pre></div><p>The outcome shows some key information, like the <em>cluster_endpoint</em> and the <em>cluster_master_version</em></p>
<h2 id="set-kubectl-context">Set Kubectl Context</h2>
<p>Let us access the cluster using kubectl.  In order to do that, we need to get credentials.  We execute the following command (which you can get from the UI on GCP right from the cluster connect window)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ gcloud container clusters get-credentials questerring-dev --zone us-west1-a --project ci-demo-206601

Fetching cluster endpoint and auth data.
kubeconfig entry generated <span style="color:#66d9ef">for</span> questerring-dev.
</code></pre></div><p>This has effectively modified our <code>kubeconfig</code> file and we now have a new context.</p>
<p>Executing the following command, we see our new cluster (in bold)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ jx context
BigDaddyO
arn:aws:eks:us-west-2:653931956080:cluster/jxcluster
gke_ci-demo-206601_europe-west1-b_sirjenkinsgke
gke_ci-demo-206601_us-west1-a_chingold
gke_ci-demo-206601_us-west1-a_questerring-dev
gke_ci-demo-206601_us-west1-a_sirjenkinsgke
gke_ci-demo-206601_us-west1-a_sirjenkinsx
gke_ci-demo-206601_us-west1_sirjenkinsxgke
minikube
1553553075211690000@jxcluster.us-west-2.eksctl.io
</code></pre></div><p>We are now ready to install Jenkins X on our cluster!</p>
<h1 id="step-6---installing-jenkins-x-on-cluster">Step 6 - Installing Jenkins X on Cluster</h1>
<p>To install Jenkins X, we simply run jx intall and follow the prompts.</p>
<p>{{ alert }}
NOTE that can pass additional flags as per your prefernces.  For example set the default admin password like so <code>--default-admin-password=MyPassw0rd</code> (see other options by typing <code>jx install --help</code>
{{ /alert }}</p>
<p>Now that we have Jenkins X installed, we can deploy an app etc.  We make sure it is up and running.</p>
<h1 id="step-7---modify-clusters">Step 7 - Modify Clusters</h1>
<p>There are certain properties that can be modified without forcing a recreation of the clusters.  You <em>do not want to recreate them as your data will be lost</em>.  Only changes that update the clusters are supported.</p>
<p>We are going to modify the cluster and add an add-on for the Dashboard which is typically disabled.</p>
<p>To do that we change the following within the cluster declaration in main.tf and add the following (in bold):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tf" data-lang="tf"><span style="color:#66d9ef">resource</span> <span style="color:#e6db74">&#34;google_container_cluster&#34; &#34;jx-cluster&#34;</span> {
<span style="color:#a6e22e">    name</span>                     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.cluster_name}&#34;</span>
<span style="color:#a6e22e">    description</span>              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;jx k8s cluster provisioned and managed via Terraform.&#34;</span>
<span style="color:#a6e22e">    zone</span>                     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.gcp_zone}&#34;</span>
<span style="color:#a6e22e">    enable_kubernetes_alpha</span>  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.enable_kubernetes_alpha}&#34;</span>
<span style="color:#a6e22e">    enable_legacy_abac</span>       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.enable_legacy_abac}&#34;</span>
<span style="color:#a6e22e">    initial_node_count</span>       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.min_node_count}&#34;</span>
<span style="color:#a6e22e">    remove_default_node_pool</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;true&#34;</span>
<span style="color:#a6e22e">    logging_service</span>          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.logging_service}&#34;</span>
<span style="color:#a6e22e">    monitoring_service</span>       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.monitoring_service}&#34;</span>

    <span style="color:#960050;background-color:#1e0010">resource_labels</span> {
<span style="color:#a6e22e">        created-by</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.created_by}&#34;</span>
<span style="color:#a6e22e">        created-timestamp</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${var.created_timestamp}&#34;</span>
<span style="color:#a6e22e">        created-with</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;managed by terraform&#34;</span>
    }

    <span style="color:#960050;background-color:#1e0010">lifecycle</span> {
<span style="color:#a6e22e">        ignore_changes</span> <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;node_pool&#34;</span>]
    }

    <span style="color:#960050;background-color:#1e0010">addons_config</span> {
        <span style="color:#960050;background-color:#1e0010">kubernetes_dashboard</span> {
<span style="color:#a6e22e">            disabled</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
        }
    }

}
</code></pre></div><p>Then we run the terraform plan, output shows a change to the cluster as expected.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ terraform plan

Refreshing Terraform state in-memory prior to plan...
The refreshed state will be used to calculate this plan, but will not be
persisted to local or remote state storage.

google_container_cluster.jx-cluster: Refreshing state... <span style="color:#f92672">(</span>ID: sposcar-dev<span style="color:#f92672">)</span>
google_container_node_pool.jx-node-pool: Refreshing state... <span style="color:#f92672">(</span>ID: us-west1-a/sposcar-dev/default-pool<span style="color:#f92672">)</span>
----

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
~ update in-place

Terraform will perform the following actions:

~ google_container_cluster.jx-cluster
addons_config.0.kubernetes_dashboard.0.disabled: <span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;false&#34;</span>
resource_labels.created-with:                    <span style="color:#e6db74">&#34;terraform&#34;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#34;managed by terraform&#34;</span>

Plan: <span style="color:#ae81ff">0</span> to add, <span style="color:#ae81ff">1</span> to change, <span style="color:#ae81ff">0</span> to destroy.

Note: You didn<span style="color:#e6db74">&#39;t specify an &#34;-out&#34; parameter to save this plan, so Terraform
</span><span style="color:#e6db74">can&#39;</span>t guarantee that exactly these actions will be performed <span style="color:#66d9ef">if</span>
<span style="color:#e6db74">&#34;terraform apply&#34;</span> is subsequently run.

</code></pre></div><h2 id="accessing-kubernetes-dashboard">Accessing kubernetes dashboard</h2>
<p>Now that our change has taken effect on our cluster, lets access the Dashboard.</p>
<p>{{ alert }}
NOTE: This dashboard is deprecated, and we are only showing you in the context of modifying your cluster to add an add-on.  Please use the GKE built-in UI
{{ /alert }}</p>
<h3 id="get-access-token">Get Access token</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">gcloud config config-helper --format<span style="color:#f92672">=</span>json | jq -r <span style="color:#e6db74">&#39;.credential.access_token&#39;</span>
</code></pre></div><p>Copy the token from the output of that command.</p>
<p>Next, execute <code>kubectl proxy</code> which will enable you to access via the following URL</p>
<p>http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy</p>
<p>Paste the token and now you should be able to access the now deprecated dashboard via the browser.</p>
<h1 id="conclusion">Conclusion</h1>
<p>We walked through how to create your initial Terraform code and structure, created the Dev cluster and modified it by specifying an add-on to include in our cluster.</p>
<p>Please keep in mind, that once <em>GitOps</em> feature in Jenkins X is available, we recommend you manage the platform in that manner.  Documentation, tutorials and presentations on that topic will be coming soon!</p>
<p>Cheers,</p>
<p><a href="http://twitter.com/SharePointOscar">@SharePointOscar</a></p>
<p>Developer Advocate | Jenkins X</p>

	

	<ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5">
  <li>
    <a href="/blog/2019/03/09/jenkins-x-cdf/" class="btn btn-primary "><span class="mr-1">←</span> Previous</a>
  </li>
    <a href="/blog/2019/04/17/jenkins-community-awards/" class="btn btn-primary ">Next <span class="ml-1">→</span></a>
  </li>
</ul>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack Signup" aria-label="Slack Signup">
    <a class="text-white" target="_blank" href="http://slack.k8s.io/">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User Slack Channel" aria-label="User Slack Channel">
    <a class="text-white" target="_blank" href="https://kubernetes.slack.com/messages/C9MBGQJRH">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" href="https://twitter.com/jenkinsxio">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Newsletter" aria-label="Newsletter">
    <a class="text-white" target="_blank" href="/community/">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" href="https://github.com/jenkins-x/jx">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer Slack Channel" aria-label="Developer Slack Channel">
    <a class="text-white" target="_blank" href="https://kubernetes.slack.com/messages/C9LTHT2BB">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
          <p class="mt-2"><a href="/about/">About Jenkins X</a></p>
        
      </div>
      <div class="col-12 text-center order-sm-4">
        <p>
          <small class="text-white">Copyright &copy; 2020 The Jenkins X Authors. All Rights Reserved</small>
          <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank">Privacy Policy</a></small>
        </p>
        <p>
          <small class="text-white">
            Copyright &copy; 2020 The Linux Foundation®. All rights reserved.<br/>
            The Linux Foundation has registered trademarks and uses trademarks.
            For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage">Trademark Usage</a> page.<br/>
            Linux is a registered trademark of Linus Torvalds.<br/>
            Linux Foundation <a href="http://www.linuxfoundation.org/privacy">Privacy Policy</a> and <a href="http://www.linuxfoundation.org/terms">Terms of Use</a>
          </small>
        </p>
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>





<script src="/js/main.min.e5b99422293e78c5f02bab3622bd8c1498b95a1a71ec8eeccf48fb97beaa63d7.js" integrity="sha256-5bmUIik&#43;eMXwK6s2Ir2MFJi5Whpx7I7sz0j7l76qY9c=" crossorigin="anonymous"></script>

<script>
  docsearch({
    apiKey: '8904bbd3ca621bef472e3de7e0e29532',
    indexName: 'jenkins_x',
    inputSelector: '#search-input',
    algoliaOptions: { 'facetFilters': ["en-us"] },
    debug: false
  });
</script>
<script>hljs.initHighlightingOnLoad();</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154682132-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-154682132-3');
</script>
<script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us7.list-manage.com","uuid":"d0c128ac1f69ba2bb20742976","lid":"84d053b0a0","uniqueMethods":true}) })</script>

  </body>
</html>